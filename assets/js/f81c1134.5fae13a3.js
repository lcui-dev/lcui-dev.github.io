"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8130],{7735:n=>{n.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"/2023/02/01/decoding-libcss-source-code","metadata":{"permalink":"/blog/2023/02/01/decoding-libcss-source-code","editUrl":"https://github.com/lcui-dev/website/tree/main/docs/blog/2023-02-01-decoding-libcss-source-code.md","source":"@site/blog/2023-02-01-decoding-libcss-source-code.md","title":"LibCSS \u7684\u6e90\u7801\u89e3\u6790","description":"LibCSS \u662f\u4e00\u4e2a CSS \u89e3\u6790\u5668\u548c\u9009\u62e9\u5f15\u64ce\uff0c\u7531 C \u8bed\u8a00\u7f16\u5199\uff0c\u662f NetSurf \u7f51\u9875\u6d4f\u89c8\u5668\u9879\u76ee\u7684\u4e00\u90e8\u5206\u4e14\u53ef\u4f9b\u5176\u5b83\u57fa\u4e8e MIT \u8bb8\u53ef\u534f\u8bae\u7684\u8f6f\u4ef6\u4f7f\u7528\u3002\u5b83\u7684\u4e3b\u8981\u7279\u6027\u5982\u4e0b\uff1a","date":"2023-02-01T00:00:00.000Z","tags":[],"readingTime":32.615,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false},"content":"LibCSS \u662f\u4e00\u4e2a CSS \u89e3\u6790\u5668\u548c\u9009\u62e9\u5f15\u64ce\uff0c\u7531 C \u8bed\u8a00\u7f16\u5199\uff0c\u662f [NetSurf](http://www.netsurf-browser.org/) \u7f51\u9875\u6d4f\u89c8\u5668\u9879\u76ee\u7684\u4e00\u90e8\u5206\u4e14\u53ef\u4f9b\u5176\u5b83\u57fa\u4e8e MIT \u8bb8\u53ef\u534f\u8bae\u7684\u8f6f\u4ef6\u4f7f\u7528\u3002\u5b83\u7684\u4e3b\u8981\u7279\u6027\u5982\u4e0b\uff1a\\n\\n- \u89e3\u6790 CSS\uff0c\u65e0\u8bba\u597d\u7684\u8fd8\u662f\u574f\u7684\\n- \u7b80\u5355\u7684 C API\\n- \u4f4e\u5185\u5b58\u5360\u7528\\n- \u5feb\u901f\u7684\u9009\u62e9\u5f15\u64ce\\n- \u53ef\u79fb\u690d\\n- \u5171\u4eab\u5e93\\n\\n\u7b14\u8005\u4e4b\u6240\u4ee5\u9009\u62e9\u7814\u7a76 LibCSS \u6e90\u7801\uff0c\u662f\u56e0\u4e3a\u5728\u6539\u9020 CSS \u5e93 lcui/css \u65f6\u9047\u5230\u4e86\u74f6\u9888\u3002\u867d\u7136\u53c2\u8003 MDN \u4e0a\u7684 [CSS \u503c\u5b9a\u4e49\u8bed\u6cd5\u6587\u6863](https://developer.mozilla.org/en-US/docs/Web/CSS/Value_definition_syntax)\u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e86 CSS \u503c\u5b9a\u4e49\u8bed\u6cd5\u7684\u89e3\u6790\u5668\u548c\u5339\u914d\u5668\uff0c\u4f46\u5728\u89e3\u51b3\u53d6\u503c\u7684\u95ee\u9898\u65f6\u4e00\u76f4\u627e\u4e0d\u5230\u6700\u4f18\u7684\u65b9\u6848\uff0c\u5176\u96be\u70b9\u5728\u4e8e CSS \u5c5e\u6027\u7684\u503c\u7684\u6570\u91cf\u548c\u7c7b\u578b\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u4e14\u7531\u4e8e `background` \u8fd9\u7c7b\u7b80\u5199\u5c5e\u6027\u7684\u5b58\u5728\uff0c\u8fd8\u5f97\u8003\u8651\u5982\u4f55\u590d\u7528\u53d6\u503c\u903b\u8f91\u3002\u56e0\u6b64 LibCSS \u4f5c\u4e3a\u4e00\u4e2a C \u8bed\u8a00\u7f16\u5199\u7684\u4e14\u5df2\u7ecf\u5386\u8fc7\u6d4f\u89c8\u5668\u8003\u9a8c\u7684\u9879\u76ee\uff0c\u5f88\u9002\u5408\u4f5c\u4e3a\u7b14\u8005\u7684\u7814\u7a76\u5bf9\u8c61\u3002\\n\\n## \u7528\u6cd5\u793a\u4f8b\\n\\nLibCSS \u7684\u793a\u4f8b\u7a0b\u5e8f\u6e90\u7801\u5728 `examples/exmaple1.c` \u4e2d\uff0c\u5b83\u5c55\u793a\u4e86\u5982\u4f55\u7528 LibCSS \u5b9e\u73b0 CSS \u6837\u5f0f\u7684\u52a0\u8f7d\u3001\u9009\u62e9\u548c\u8bfb\u53d6\uff0c\u6211\u4eec\u5148\u4ece\u5b83\u5165\u624b\uff0c\u4e86\u89e3 LibCSS \u5927\u81f4\u7684\u7528\u6cd5\u548c\u6982\u5ff5\uff0c\u4ee5\u4fbf\u4e8e\u540e\u7eed\u7684\u6df1\u5165\u7814\u7a76\u3002\\n\\n\u9996\u5148\u4ece `main()` \u51fd\u6570\u5f00\u59cb\uff0c\u5f00\u5934\u90e8\u5206\u7684\u4ee3\u7801\u521d\u59cb\u5316\u4e86 CSS \u5b57\u7b26\u4e32\u3001\u6837\u5f0f\u8868\u7684\u521b\u5efa\u53c2\u6570\u3002\\n\\n```c\\n        css_error code;\\n        css_stylesheet *sheet;\\n        size_t size;\\n        const char data[] = \\"h1 { color: red } \\"\\n                \\"h4 { color: #321; } \\"\\n                \\"h4, h5 { color: #123456; }\\";\\n        css_select_ctx *select_ctx;\\n        uint32_t count;\\n        unsigned int hh;\\n        css_stylesheet_params params;\\n        css_media media = {\\n                .type = CSS_MEDIA_SCREEN,\\n        };\\n\\n        UNUSED(argc);\\n        UNUSED(argv);\\n\\n        params.params_version = CSS_STYLESHEET_PARAMS_VERSION_1;\\n        params.level = CSS_LEVEL_21;\\n        params.charset = \\"UTF-8\\";\\n        params.url = \\"foo\\";\\n        params.title = \\"foo\\";\\n        params.allow_quirks = false;\\n        params.inline_style = false;\\n        params.resolve = resolve_url;\\n        params.resolve_pw = NULL;\\n        params.import = NULL;\\n        params.import_pw = NULL;\\n        params.color = NULL;\\n        params.color_pw = NULL;\\n        params.font = NULL;\\n        params.font_pw = NULL;\\n\\n```\\n\\n\u7136\u540e\uff0c\u521b\u5efa\u6837\u5f0f\u8868\uff0c\u89e3\u6790 CSS \u5b57\u7b26\u4e32\u5e76\u8ffd\u52a0\u8fdb\u6837\u5f0f\u8868\u4e2d\u3002\\n\\n```c\\n        /* create a stylesheet */\\n        code = css_stylesheet_create(&params, &sheet);\\n        if (code != CSS_OK)\\n                die(\\"css_stylesheet_create\\", code);\\n        code = css_stylesheet_size(sheet, &size);\\n        if (code != CSS_OK)\\n                die(\\"css_stylesheet_size\\", code);\\n        printf(\\"created stylesheet, size %zu\\\\n\\", size);\\n\\n        /* parse some CSS source */\\n        code = css_stylesheet_append_data(sheet, (const uint8_t *) data,\\n                        sizeof data);\\n        if (code != CSS_OK && code != CSS_NEEDDATA)\\n                die(\\"css_stylesheet_append_data\\", code);\\n        code = css_stylesheet_data_done(sheet);\\n        if (code != CSS_OK)\\n                die(\\"css_stylesheet_data_done\\", code);\\n        code = css_stylesheet_size(sheet, &size);\\n        if (code != CSS_OK)\\n                die(\\"css_stylesheet_size\\", code);\\n        printf(\\"appended data, size now %zu\\\\n\\", size);\\n```\\n\\n\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u5728 LibCSS \u7684\u8bbe\u8ba1\u4e2d\u6837\u5f0f\u89e3\u6790\u548c\u5b58\u50a8\u662f\u56f4\u7ed5\u6837\u5f0f\u8868\u8fdb\u884c\u7684\uff0c`css_stylesheet_append_data()` \u51fd\u6570\u80fd\u591f\u89e3\u6790 CSS \u4ee3\u7801\u5b57\u7b26\u4e32\u5e76\u5c06\u7ed3\u679c\u5b58\u50a8\u5230\u6837\u5f0f\u8868\u4e2d\u3002\\n\\n\u63a5\u7740\u662f\u521b\u5efa\u9009\u62e9\u4e0a\u4e0b\u6587\uff0c\u5c06\u4e0a\u9762\u65b0\u5efa\u7684\u6837\u5f0f\u8868\u8ffd\u52a0\u8fdb\u9009\u62e9\u4e0a\u4e0b\u6587\u4e2d\u3002\\n\\n```c\\n        /* prepare a selection context containing the stylesheet */\\n        code = css_select_ctx_create(&select_ctx);\\n        if (code != CSS_OK)\\n                die(\\"css_select_ctx_create\\", code);\\n        code = css_select_ctx_append_sheet(select_ctx, sheet, CSS_ORIGIN_AUTHOR,\\n                        NULL);\\n        if (code != CSS_OK)\\n                die(\\"css_select_ctx_append_sheet\\", code);\\n        code = css_select_ctx_count_sheets(select_ctx, &count);\\n        if (code != CSS_OK)\\n                die(\\"css_select_ctx_count_sheets\\", code);\\n        printf(\\"created selection context with %i sheets\\\\n\\", count);\\n```\\n\\n\u6700\u540e\uff0c\u9009\u62e9\u6837\u5f0f\uff0c\u8f93\u51fa\u9009\u62e9\u7ed3\u679c\uff1a\\n\\n```c\\n        /* select style for each of h1 to h6 */\\n        for (hh = 1; hh != 7; hh++) {\\n                css_select_results *style;\\n                char element[20];\\n                lwc_string *element_name;\\n                uint8_t color_type;\\n                css_color color_shade;\\n\\n                /* in this very simple example our \\"document tree\\" is just one\\n                 * node and is in fact a libwapcaplet string containing the\\n                 * element name */\\n                snprintf(element, sizeof element, \\"h%i\\", hh);\\n                lwc_intern_string(element, strlen(element), &element_name);\\n\\n                code = css_select_style(select_ctx, element_name,\\n                                &media, NULL,\\n                                &select_handler, 0,\\n                                &style);\\n                if (code != CSS_OK)\\n                        die(\\"css_select_style\\", code);\\n\\n                lwc_string_unref(element_name);\\n\\n                color_type = css_computed_color(\\n                                style->styles[CSS_PSEUDO_ELEMENT_NONE],\\n                                &color_shade);\\n                if (color_type == CSS_COLOR_INHERIT)\\n                        printf(\\"color of h%i is \'inherit\'\\\\n\\", hh);\\n                else\\n                        printf(\\"color of h%i is %x\\\\n\\", hh, color_shade);\\n\\n                code = css_select_results_destroy(style);\\n                if (code != CSS_OK)\\n                        die(\\"css_computed_style_destroy\\", code);\\n        }\\n\\n```\\n\\n`css_select_style()` \u7528\u4e8e\u6839\u636e\u7ed9\u5b9a\u7684\u9009\u62e9\u4e0a\u4e0b\u6587\u548c\u7ed3\u70b9\u6765\u9009\u62e9\u5339\u914d\u7684\u6837\u5f0f\u3002\u5b83\u63a5\u53d7 7 \u4e2a\u53c2\u6570\uff0c\u5176\u4e2d\u7684 node \u53c2\u6570\u6307\u5b9a\u4e86\u7528\u4e8e\u9009\u62e9\u6837\u5f0f\u7684\u7ed3\u70b9\uff0chandler \u53c2\u6570\u63d0\u4f9b node \u7684\u5404\u79cd\u5c5e\u6027\u7684\u83b7\u53d6\u65b9\u6cd5\u3002\u7531\u6b64\u53ef\u89c1\u5176\u5b83 UI \u5e93\u82e5\u8981\u4f7f\u7528 LibCSS \u5b9e\u73b0\u5bf9 CSS \u7684\u652f\u6301\u7684\u8bdd\u662f\u6bd4\u8f83\u5bb9\u6613\u7684\uff0c\u53ea\u9700\u8981\u51c6\u5907\u597d\u63a7\u4ef6\u53e5\u67c4/\u6307\u9488\u548c\u63a7\u4ef6\u7684\u5404\u79cd\u64cd\u4f5c\u51fd\u6570\u5408\u96c6\u5373\u53ef\u3002\\n\\n`css_computed_color()` \u7528\u4e8e\u4ece\u5df2\u8ba1\u7b97\u6837\u5f0f\u4e2d\u83b7\u53d6 color \u5c5e\u6027\u7684\u503c\uff0c\u4f20\u5165\u5df2\u8ba1\u7b97\u6837\u5f0f\u548c\u63a5\u53d7\u503c\u7684\u6307\u9488\uff0c\u8fd4\u56de\u503c\u662f\u989c\u8272\u7c7b\u578b\u3002\u4ece\u8fd9\u4e2a\u51fd\u6570\u7684\u8c03\u7528\u4ee3\u7801\u4e2d\u6211\u4eec\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u5730\u63a8\u6d4b\u51fa\u5176\u5b83\u5c5e\u6027\u4e5f\u6709\u5bf9\u5e94\u7684\u4ee5 `css_computed_` \u5f00\u5934\u547d\u540d\u7684\u51fd\u6570\u6765\u83b7\u53d6\u503c\uff0c\u4e14\u7528\u6cd5\u57fa\u672c\u4e00\u6837\u3002\u53e6\u5916\uff0c\u5b83\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570 `style->styles` \u662f\u4e2a\u6570\u7ec4\u4e14\u6307\u5b9a\u4e86 `CSS_PSEUDO_ELEMENT_NONE` \u4e0b\u6807\uff0c\u8fd9\u8868\u660e\u6837\u5f0f\u9009\u62e9\u7ed3\u679c\u4e2d\u4e0d\u53ea\u6709\u5143\u7d20\u672c\u8eab\u7684\u6837\u5f0f\uff0c\u8fd8\u5305\u62ec\u5176\u5b83\u4f2a\u5143\u7d20\u7684\u6837\u5f0f\u3002\\n\\n## \u89e3\u6790\\n\\n\u901a\u8fc7\u7814\u7a76\u4e0a\u8ff0\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053 `css_stylesheet_append_data()` \u80fd\u89e3\u6790 CSS \u5b57\u7b26\u4e32\uff0c\u4ee5\u5b83\u4e3a\u8d77\u70b9\u8fdb\u884c\u67e5\u627e\uff0c\u53ef\u4ee5\u627e\u5230\u5305\u62ec\u6570\u636e\u7ed3\u6784\u3001\u51fd\u6570\u3001\u53d8\u91cf\u5728\u5185\u7684\u76f8\u5173\u4f9d\u8d56\u9879\uff1a\\n\\n- `css_parser`\\n- `css_lexer`\\n- `css_language`\\n- `css_parser_event`\\n- `css_parser_event_handler`\\n- `css__parser_parse_chunk()`\\n- `parser_state`\\n- `parseFuncs`\\n- `css__language_create()`\\n- `language_handle_event()`\\n- `parseProperty`\\n- `property_handlers`\\n\\n\u4ee5\u8fd9\u4e9b\u4f9d\u8d56\u9879\u4e3a\u7ebf\u7d22\u7ee7\u7eed\u6df1\u5165\u7814\u7a76\u4ee3\u7801\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u6574\u4e2a\u89e3\u6790\u529f\u80fd\u6d89\u53ca\u5230\u8bed\u8a00\u89e3\u6790\u5668\u3001\u89e3\u6790\u5668\u524d\u7aef\u3001\u89e3\u6790\u5668\u3001\u89e3\u6790\u5668\u4e8b\u4ef6\u3001\u8bcd\u6cd5\u5206\u6790\u5668\u8fd9\u4e9b\u6982\u5ff5\uff0c\u6e90\u7801\u6d89\u53ca parse.c\u3001lex.c\u3001langguage.c\u3001properties.c \u7b49\u6587\u4ef6\uff0c\u63a5\u4e0b\u6765\u672c\u6587\u5c06\u9010\u4e2a\u8bb2\u89e3\u5b83\u4eec\u3002\\n\\n### \u8bcd\u6cd5\u5206\u6790\u5668\\n\\n\u8bcd\u6cd5\u5206\u6790\u5668\uff08Lexer\uff09\u7684\u804c\u8d23\u662f\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u4e00\u4e2a\u4e2a\u8bcd\u6cd5\u5355\u5143\uff08Token\uff09\uff0c\u5b83\u57fa\u4e8e\u6709\u9650\u72b6\u6001\u81ea\u52a8\u673a\u8fdb\u884c\u89e3\u6790\uff0c\u5927\u81f4\u7684\u89e3\u6790\u8fc7\u7a0b\u662f\u6839\u636e\u5b57\u7b26\u5185\u5bb9\u66f4\u65b0\u72b6\u6001\uff0c\u7136\u540e\u8c03\u7528\u4e0e\u72b6\u6001\u5bf9\u5e94\u7684\u65b9\u6cd5\u53bb\u89e3\u6790\u540e\u7eed\u5b57\u7b26\u3002\\n\\n\u8bcd\u6cd5\u5355\u5143\u7684\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a\\n\\n```c\\ntypedef struct css_token {\\n        css_token_type type;\\n\\n        struct {\\n                uint8_t *data;\\n                size_t len;\\n        } data;\\n\\n        lwc_string *idata;\\n\\n        uint32_t col;\\n        uint32_t line;\\n} css_token;\\n```\\n\\n\u5b83\u5305\u542b\u7c7b\u578b\u3001\u6570\u636e\u3001\u884c\u5217\uff0c`data.data` \u548c `data.len` \u6210\u5458\u8bb0\u5f55\u4e86\u5b57\u7b26\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e\u548c\u957f\u5ea6\uff0c\u7531\u6b64\u53ef\u89c1\u8bcd\u6cd5\u5355\u5143\u672c\u8d28\u4e0a\u5c31\u662f\u5bf9\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u6bb5\u5b57\u7b26\u4e32\u7684\u6807\u8bb0\u3002\\n\\n\u81f3\u4e8e\u72b6\u6001\u81ea\u52a8\u673a\uff0c\u5b83\u7684\u5b9e\u73b0\u4ee3\u7801\u53ef\u4ee5\u6982\u62ec\u4e3a\uff1a\\n\\n```c\\ncss_error \u83b7\u53d6\u8bcd\u6cd5\u5355\u5143(css_lexer *\u8bcd\u6cd5\u5206\u6790\u5668, css_token **\u8bcd\u6cd5\u5355\u5143)\\n{\\n        switch (\u8bcd\u6cd5\u5206\u6790\u5668->\u72b6\u6001) {\\n        case \u521d\u59cb\u72b6\u6001\uff1a\\n                return \u521d\u59cb\u72b6\u6001\u7684\u52a8\u4f5c(\u8bcd\u6cd5\u5206\u6790\u5668, \u8bcd\u6cd5\u5355\u5143);\\n        case \u72b6\u60011:\\n                return \u72b6\u60011\u7684\u52a8\u4f5c(\u8bcd\u6cd5\u5206\u6790\u5668, \u8bcd\u6cd5\u5355\u5143);\\n        case \u72b6\u60012:\\n        ...\\n        }\\n}\\n```\\n\\n\u6574\u4e2a\u89e3\u6790\u8fc7\u7a0b\u57fa\u4e8e\u72b6\u6001\u9a71\u52a8\uff0c\u6bcf\u79cd\u72b6\u6001\u90fd\u6709\u5bf9\u5e94\u7684\u52a8\u4f5c\uff0c\u52a8\u4f5c\u6267\u884c\u5b8c\u540e\u72b6\u6001\u4f1a\u88ab\u6539\u4e3a\u53e6\u4e00\u4e2a\u72b6\u6001\uff0c\u5982\u6b64\u5f80\u590d\u76f4\u5230\u5b57\u7b26\u4e32\u5168\u90e8\u89e3\u6790\u5b8c\u4e3a\u6b62\u3002\u8fd9\u79cd\u8fd0\u8f6c\u673a\u5236\uff0c\u5c31\u662f\u6709\u9650\u72b6\u6001\u81ea\u52a8\u673a\u3002\\n\\n### \u89e3\u6790\u5668\\n\\n\u89e3\u6790\u5668\uff08Parser\uff09\u7684\u804c\u8d23\u662f\u89e3\u6790\u8bcd\u6cd5\u5355\u5143\u5e8f\u5217\u8868\u8fbe\u7684\u8bed\u4e49\u3002\u4e0e\u8bcd\u6cd5\u5206\u6790\u5668\u76f8\u540c\u4e4b\u5904\u662f\u5b83\u4e5f\u57fa\u4e8e\u6709\u9650\u72b6\u6001\u81ea\u52a8\u673a\uff0c\u5176\u5927\u81f4\u7684\u89e3\u6790\u8fc7\u7a0b\u662f\u8c03\u7528\u8bcd\u6cd5\u5206\u6790\u5668\u83b7\u53d6\u4e0b\u4e2a\u8bcd\u6cd5\u5355\u5143\uff0c\u7136\u540e\u6839\u636e\u8bcd\u6cd5\u5355\u5143\u5185\u5bb9\u66f4\u65b0\u72b6\u6001\uff0c\u4e4b\u540e\u8c03\u7528\u5bf9\u5e94\u7684\u5b50\u89e3\u6790\u5668\u3002\u800c\u4e0d\u540c\u4e4b\u5904\u662f\u5b83\u7684\u89e3\u6790\u7ed3\u679c\u662f\u901a\u8fc7\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\u4f20\u9012\u7684\uff0c\u4e8b\u4ef6\u679a\u4e3e\u5728 src/parse/parse.h \u6587\u4ef6\u4e2d\u6709\u5b9a\u4e49\uff1a\\n\\n```c\\ntypedef enum css_parser_event {\\n        CSS_PARSER_START_STYLESHEET,\\n        CSS_PARSER_END_STYLESHEET,\\n        CSS_PARSER_START_RULESET,\\n        CSS_PARSER_END_RULESET,\\n        CSS_PARSER_START_ATRULE,\\n        CSS_PARSER_END_ATRULE,\\n        CSS_PARSER_START_BLOCK,\\n        CSS_PARSER_END_BLOCK,\\n        CSS_PARSER_BLOCK_CONTENT,\\n        CSS_PARSER_END_BLOCK_CONTENT,\\n        CSS_PARSER_DECLARATION\\n} css_parser_event;\\n```\\n\\n\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u4e8b\u4ef6\u6d89\u53ca\u6837\u5f0f\u8868\u3001\u89c4\u5219\u96c6\u3001`@` \u89c4\u5219\u3001\u5757\u3001\u5757\u5185\u5bb9\u3001\u58f0\u660e\uff0c\u5728\u5b83\u4eec\u5f00\u59cb\u548c\u7ed3\u675f\u89e3\u6790\u7684\u65f6\u5019\u4f1a\u89e6\u53d1\u4e8b\u4ef6\u3002\\n\\n### \u8bed\u8a00\u89e3\u6790\u5668\\n\\n\u8bed\u8a00\u89e3\u6790\u5668\u4f5c\u4e3a\u89e3\u6790\u5668\u7684\u524d\u7aef\uff0c\u8d1f\u8d23\u5bf9\u63a5\u5c5e\u6027\u89e3\u6790\u5668\u548c\u89e3\u6790\u5668\uff0c\u5c06\u89e3\u6790\u7ed3\u679c\u8f93\u51fa\u5230\u6837\u5f0f\u8868\u3002\\n\\nsrc/parse/language.c \u6587\u4ef6\u4e2d `css__language_create()` \u51fd\u6570\u5305\u542b\u4e86\u8bed\u8a00\u89e3\u6790\u5668\u7684\u521b\u5efa\u8fc7\u7a0b\uff0c\u5176\u4e2d\u6709\u4e00\u6bb5\u662f\u5c06 `language_handle_event` \u51fd\u6570\u8bbe\u4e3a\u89e3\u6790\u5668\u7684\u4e8b\u4ef6\u5904\u7406\u5668\uff1a\\n\\n```c\\n        params.event_handler.handler = language_handle_event;\\n        params.event_handler.pw = c;\\n        error = css__parser_setopt(parser, CSS_PARSER_EVENT_HANDLER, &params);\\n        if (error != CSS_OK) {\\n                parserutils_stack_destroy(c->context);\\n                free(c);\\n                return error;\\n        }\\n```\\n\\n`language_handle_event` \u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u6839\u636e\u89e3\u6790\u5668\u7684\u4e8b\u4ef6\u6765\u5bf9\u540e\u7eed\u8bcd\u6cd5\u5355\u5143\u505a\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u5176\u4e2d\u5305\u62ec\u89e3\u6790\u9009\u62e9\u5668\u3001\u89e3\u6790 `@` \u89c4\u5219\u3001\u8c03\u7528\u5c5e\u6027\u89e3\u6790\u5668\u7b49\u3002\\n\\n### \u5c5e\u6027\u89e3\u6790\u5668\\n\\n\u5c5e\u6027\u89e3\u6790\u5668\u7684\u804c\u8d23\u662f\u5728\u89e3\u6790\u5668\u89e3\u6790\u6837\u5f0f\u58f0\u660e\u65f6\u5c06\u6bcf\u6761\u5c5e\u6027\u8f6c\u6362\u6210\u4e00\u4e2a\u4e2a\u8fde\u7eed\u7684\u5b57\u8282\u7801\u5b58\u5165\u6837\u5f0f\u8868\u4e2d\u3002\\n\\nLibCSS \u7684\u5c5e\u6027\u89e3\u6790\u5668\u6e90\u7801\u662f\u7531\u751f\u6210\u5668\u81ea\u52a8\u751f\u6210\u7684\uff0cMakefile \u4e2d\u6709\u5177\u4f53\u7684\u751f\u6210\u65b9\u6cd5\uff1a\\n\\n```makefile\\n# Sources\\n\\nAUTOGEN_PARSERS := $(shell $(PERL) -pe\'$$_=\\"\\" unless /^([^\\\\#][^:]+):/;$$_=$$1 . \\" \\"\' $(DIR)properties.gen)\\n\\n# Dodgy use of define/eval to bypass DIR changing\\ndefine build_gen_parser\\n\\n$(BUILDDIR)/gen_parser: $(DIR)css_property_parser_gen.c\\n        $$(VQ)$$(ECHO) $$(ECHOFLAGS) \\" PREPARE: $$@\\"\\n        $$(Q)$$(BUILD_CC) -o $$@ $$^\\n\\nendef\\n\\n$(eval $(build_gen_parser))\\n\\ndefine gen_prop_parser\\n\\n$(DIR)autogenerated_$1.c: $(DIR)properties.gen $(BUILDDIR)/gen_parser\\n        $$(VQ)$$(ECHO) $$(ECHOFLAGS) \\"GENERATE: $$@\\"\\n        $$(Q)$$(BUILDDIR)/gen_parser -o $$@ \'$(shell $(GREP) \\"^$1:\\" $(DIR)properties.gen)\'\\n\\nAUTOGEN_SOURCES := $$(AUTOGEN_SOURCES) autogenerated_$1.c\\n\\nendef\\n\\nAUTOGEN_SOURCES :=\\n\\n$(eval $(foreach PROP,$(AUTOGEN_PARSERS),$(call gen_prop_parser,$(PROP))))\\n```\\n\\n\u5c5e\u6027\u89e3\u6790\u5668\u6e90\u6587\u4ef6\u547d\u540d\u683c\u5f0f\u4e3a `autogenerated_${\u5c5e\u6027\u540d}.c`\uff0c \u90fd\u4f9d\u8d56\u751f\u6210\u5668 `gen_parser`\uff0cmake \u65f6\u4f1a\u8c03\u7528\u751f\u6210\u5668\u4e3a `properties.gen` \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2a\u5c5e\u6027\u751f\u6210\u89e3\u6790\u5668\u6e90\u6587\u4ef6\u3002\\n\\n`properties.gen` \u6587\u4ef6\u5934\u90e8\u6709\u7ed9\u51fa\u5c5e\u6027\u5b9a\u4e49\u683c\u5f0f\u793a\u4f8b\uff1a\\n\\n```text\\n##Common templates\\n#\\n#property:CSS_PROP_ENUM IDENT:( INHERIT: IDENT:)\\n#property:CSS_PROP_ENUM IDENT:INHERIT NUMBER:( false: RANGE: NUMBER:)\\n#property:CSS_PROP_ENUM IDENT:INHERIT LENGTH_UNIT:( UNIT_HZ:PITCH_FREQUENCY ALLOW: DISALLOW: RANGE:<0 LENGTH_UNIT:)\\n#property:CSS_PROP_ENUM IDENT:( INHERIT: IDENT:) LENGTH_UNIT:( UNIT_HZ:PITCH_FREQUENCY ALLOW: DISALLOW: RANGE:<0 LENGTH_UNIT:)\\n#property:CSS_PROP_ENUM WRAP:\\n```\\n\\n\u5728\u8fd9\u79cd\u8bbe\u8ba1\u4e2d\uff0c\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u6dfb\u52a0\u65b9\u5f0f\u5e94\u8be5\u662f\u5148\u5728 `properties.gen` \u6dfb\u52a0\u5c5e\u6027\u5b9a\u4e49\uff0c\u7136\u540e\u8fd0\u884c make \u547d\u4ee4\u751f\u6210\u89e3\u6790\u5668\u6e90\u6587\u4ef6\uff0c\u4e4b\u540e\u91cd\u65b0\u7f16\u8bd1 LibCSS\u3002\\n\\n### \u7b80\u5199\u5c5e\u6027\u89e3\u6790\u5668\\n\\n> \u7b80\u5199\u5c5e\u6027\u662f\u53ef\u4ee5\u8ba9\u4f60\u540c\u65f6\u8bbe\u7f6e\u597d\u51e0\u4e2a CSS \u5c5e\u6027\u503c\u7684 CSS \u5c5e\u6027\u3002\u4f7f\u7528\u7b80\u5199\u5c5e\u6027\uff0cWeb \u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7f16\u5199\u66f4\u7b80\u6d01\u3001\u66f4\u5177\u53ef\u8bfb\u6027\u7684\u6837\u5f0f\u8868\uff0c\u8282\u7701\u65f6\u95f4\u548c\u7cbe\u529b\u3002\\n>\\n> **_\u6458\u81ea [CSS \u7684\u7b80\u5199\u5c5e\u6027 - CSS\uff08\u5c42\u53e0\u6837\u5f0f\u8868\uff09 | MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Shorthand_properties)_**\\n\\n\u4ee5\u7b80\u5199\u5c5e\u6027 background \u4e3a\u4f8b\uff0c\u5b83\u7684\u89e3\u6790\u5668\u6e90\u6587\u4ef6\u662f parse/properties/background.c\uff0c\u5176\u4e2d\u7684 `css__parse_background()` \u51fd\u6570\u5305\u542b\u4e86\u5c5e\u6027\u7684\u89e3\u6790\u8fc7\u7a0b\u3002\\n\\n\u51fd\u6570\u5f00\u5934\u5904\u5b9a\u4e49\u4e86\u51e0\u4e2a\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u975e\u7b80\u5199\u5c5e\u6027\u7684\u503c\u548c\u89e3\u6790\u72b6\u6001\uff08\u662f\u5426\u9700\u89e3\u6790\uff09\u3002\\n\\n```c\\n        bool attachment = true;\\n        bool color = true;\\n        bool image = true;\\n        bool position = true;\\n        bool repeat = true;\\n        css_style * attachment_style;\\n        css_style * color_style;\\n        css_style * image_style;\\n        css_style * position_style;\\n        css_style * repeat_style;\\n```\\n\\n\u9996\u5148\u662f\u5904\u7406\u7ee7\u627f\uff0c\u5982\u679c\u5c5e\u6027\u503c\u662f `inherit` \u5219\u4e3a\u6bcf\u4e2a\u5c5e\u6027\u8ffd\u52a0\u5e26 `inherit` \u6807\u8bb0\u7684\u5b57\u8282\u7801\u3002\\n\\n```c\\n        /* Firstly, handle inherit */\\n        token = parserutils_vector_peek(vector, *ctx);\\n        if (token == NULL)\\n                return CSS_INVALID;\\n\\n        if (is_css_inherit(c, token)) {\\n                error = css_stylesheet_style_inherit(result, CSS_PROP_BACKGROUND_ATTACHMENT);\\n                if (error != CSS_OK)\\n                        return error;\\n                ...\\n        }\\n```\\n\\n\u7ed9\u6bcf\u4e2a\u5c5e\u6027\u5206\u914d\u5185\u5b58\u8d44\u6e90\u3002\\n\\n```c\\n        /* allocate styles */\\n        error = css__stylesheet_style_create(c->sheet, &attachment_style);\\n        if (error != CSS_OK)\\n                return error;\\n        ...\\n```\\n\\n\u904d\u5386\u6bcf\u4e2a\u8bcd\u6cd5\u5355\u5143\uff0c\u5c1d\u8bd5\u7528\u6bcf\u4e2a\u975e\u7b80\u5199\u5c5e\u6027\u7684\u89e3\u6790\u51fd\u6570\u89e3\u6790\u5b83\uff0c\u82e5\u89e3\u6790\u6210\u529f\u5219\u6807\u8bb0\u8be5\u5c5e\u6027\u4e3a\u4e0d\u9700\u8981\u518d\u89e3\u6790\u3002\\n\\n```c\\n        /* Attempt to parse the various longhand properties */\\n        do {\\n                prev_ctx = *ctx;\\n                error = CSS_OK;\\n\\n                if (is_css_inherit(c, token)) {\\n                        error = CSS_INVALID;\\n                        goto css__parse_background_cleanup;\\n                }\\n\\n                /* Try each property parser in turn, but only if we\\n                 * haven\'t already got a value for this property.\\n                 */\\n                if ((attachment) &&\\n                        (error = css__parse_background_attachment(c, vector, ctx,\\n                                                attachment_style)) == CSS_OK) {\\n                        attachment = false;\\n                } else if ((color) && ...\\n        } while (*ctx != prev_ctx && token != NULL);\\n\\n        if (attachment) {\\n                error = css__stylesheet_style_appendOPV(attachment_style,\\n                                CSS_PROP_BACKGROUND_ATTACHMENT, 0,\\n                                BACKGROUND_ATTACHMENT_SCROLL);\\n                if (error != CSS_OK)\\n                        goto css__parse_background_cleanup;\\n        }\\n        ...\\n```\\n\\n\u89e3\u6790\u5b8c\u540e\uff0c\u7ed9\u672a\u83b7\u5f97\u503c\u7684\u5c5e\u6027\u8ffd\u52a0\u521d\u59cb\u503c\uff1a\\n\\n```c\\n        if (attachment) {\\n                error = css__stylesheet_style_appendOPV(attachment_style,\\n                                CSS_PROP_BACKGROUND_ATTACHMENT, 0,\\n                                BACKGROUND_ATTACHMENT_SCROLL);\\n                if (error != CSS_OK)\\n                        goto css__parse_background_cleanup;\\n        }\\n\\n        if (color) {\\n                ...\\n```\\n\\n\u4e4b\u540e\uff0c\u5c06\u6bcf\u4e2a\u975e\u7b80\u5199\u5c5e\u6027\u503c\u5408\u5e76\u8fdb\u7ed3\u679c\u4e2d\u3002\\n\\n```c\\n        error = css__stylesheet_merge_style(result, attachment_style);\\n        if (error != CSS_OK)\\n                goto css__parse_background_cleanup;\\n        ...\\n```\\n\\n\u6700\u540e\uff0c\u9500\u6bc1\u76f8\u5173\u6570\u636e\u3002\\n\\n```c\\n        css__stylesheet_style_destroy(attachment_style);\\n        ...\\n        return error;\\n```\\n\\n\u4ee5\u4e0a\u5c31\u662f background \u5c5e\u6027\u7684\u89e3\u6790\u8fc7\u7a0b\uff0c\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u7b80\u5199\u5c5e\u6027\u81ea\u8eab\u5e76\u4e0d\u5360\u7528\u6837\u5f0f\u5b58\u50a8\u7a7a\u95f4\uff0c\u5b83\u4f1a\u5728\u89e3\u6790\u9636\u6bb5\u88ab\u5206\u89e3\u6210\u82e5\u5e72\u4e2a\u975e\u7b80\u5199\u5c5e\u6027\u8fdb\u884c\u89e3\u6790\u548c\u5b58\u50a8\uff0c\u5206\u89e3\u7684\u8fc7\u7a0b\u5c31\u662f\u904d\u5386\u6bcf\u4e2a\u503c\u7136\u540e\u9010\u4e2a\u68c0\u6d4b\u662f\u5426\u4e0e\u54ea\u4e2a\u975e\u7b80\u5199\u5c5e\u6027\u5339\u914d\u3002\\n\\n## \u8ba1\u7b97\\n\\n`css_select_style()` \u51fd\u6570\u5b9e\u73b0\u4e86\u6837\u5f0f\u9009\u62e9\u548c\u8ba1\u7b97\u529f\u80fd\uff0c\u5b83\u6240\u89e3\u51b3\u7684\u95ee\u9898\u53ef\u5206\u4e3a\u516d\u7c7b\uff1a\u6307\u793a\u3001\u9009\u62e9\u3001\u5c42\u53e0\u3001\u5185\u8054\u3001\u521d\u59cb\u503c\u3001\u7edd\u5bf9\u503c\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8be5\u51fd\u6570\u7684\u6ce8\u91ca\u4e2d\u6709\u63d0\u5230\u5b83\u751f\u6210\u7684\u5df2\u8ba1\u7b97\u6837\u5f0f\u8fd8\u4e0d\u80fd\u7acb\u5373\u4f7f\u7528\uff0c\u9700\u8981\u8c03\u7528 `css_computed_style_compose()` \u83b7\u53d6\u5b8c\u6574\u7684\u5df2\u8ba1\u7b97\u6837\u5f0f\uff0c\u8fd9\u79cd\u4e24\u6b65\u5f0f\u6837\u5f0f\u8ba1\u7b97\u65b9\u6cd5\u65e8\u5728\u5141\u8bb8\u5ba2\u6237\u7aef\u5b58\u50a8\u90e8\u5206\u5df2\u8ba1\u7b97\u6837\u5f0f\uff0c\u5e76\u5728\u5e03\u5c40\u53d8\u52a8\u65f6\u9ad8\u6548\u5730\u66f4\u65b0\u8282\u70b9\u7684\u5b8c\u6574\u5df2\u8ba1\u7b97\u6837\u5f0f\u3002\\n\\n### \u6307\u793a\\n\\n\u6307\u793a\uff08Hinting\uff09\u7528\u4e8e\u8ba9\u5143\u7d20\u5bf9\u6837\u5f0f\u505a\u81ea\u5b9a\u4e49\u7684\u63a7\u5236\u3002`css_select_style()` \u51fd\u6570\u5728\u521d\u59cb\u5316\u9009\u62e9\u72b6\u6001\u540e\u4f1a\u8c03\u7528 `node_presentational_hint` \u56de\u8c03\u51fd\u6570\u83b7\u53d6\u5143\u7d20\u7684\u5c55\u73b0\u6307\u793a\uff0c\u8fd9\u4e9b\u6307\u793a\u7684\u4f5c\u7528\u76f8\u5f53\u4e8e\u5143\u7d20\u5185\u90e8\u81ea\u5b9a\u4e49\u4e86\u90e8\u5206\u5c5e\u6027\u7684\u521d\u59cb\u503c\uff0c\u5178\u578b\u7684\u4f8b\u5b50\u5c31\u662f canvas \u5143\u7d20\uff0c\u5b83\u7ed9 width \u548c height \u5c5e\u6027\u6307\u793a\u7684\u503c\u5206\u522b\u662f 300 \u548c 150\u3002\\n\\n### \u9009\u62e9\\n\\n\u9009\u62e9\uff08Selection\uff09\u662f CSS \u5f15\u64ce\u7684\u6838\u5fc3\u529f\u80fd\uff0c\u5176\u4f5c\u7528\u662f\u4ece\u6837\u5f0f\u8868\u4e2d\u67e5\u627e\u4e0e\u5143\u7d20\u5339\u914d\u7684\u89c4\u5219\u96c6\u3002\u7531\u4e8e\u9009\u62e9\u5f15\u64ce\u5e76\u4e0d\u5728\u672c\u6587\u7684\u7814\u7a76\u8303\u56f4\u5185\uff0c\u672c\u6587\u4e0d\u4f1a\u7ee7\u7eed\u5bf9\u5b83\u505a\u8fdb\u4e00\u6b65\u7684\u8bb2\u89e3\uff0c\u5982\u9700\u4e86\u89e3\u66f4\u591a\uff0c\u8bf7\u81ea\u884c\u67e5\u9605 LibCSS \u4ee3\u7801\u5e93\u4e2d\u7684 src/select/select.c \u6587\u4ef6\u3002\\n\\n### \u5c42\u53e0\\n\\n\u5c42\u53e0\uff08Cascade\uff09\u7684\u4f5c\u7528\u662f\u4e3a\u4e86\u4ece\u5339\u914d\u5230\u7684\u89c4\u5219\u96c6\u4e2d\u9009\u53d6\u6743\u91cd\u6700\u9ad8\u7684\u89c4\u5219\u3002`css_select_style()` \u5728\u67e5\u627e\u5230\u5339\u914d\u7684\u89c4\u5219\u540e\u4f1a\u8c03\u7528 `cascade_style()` \u51fd\u6570\u5c42\u53e0\u6837\u5f0f\uff0c\u5176\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```c\\ncss_error cascade_style(const css_style *style, css_select_state *state)\\n{\\n        css_style s = *style;\\n\\n        while (s.used > 0) {\\n                opcode_t op;\\n                css_error error;\\n                css_code_t opv = *s.bytecode;\\n\\n                advance_bytecode(&s, sizeof(opv));\\n\\n                op = getOpcode(opv);\\n\\n                error = prop_dispatch[op].cascade(opv, &s, state);\\n                if (error != CSS_OK)\\n                        return error;\\n        }\\n\\n        return CSS_OK;\\n}\\n```\\n\\n\u4ece\u8fd9\u6bb5\u7b80\u77ed\u7684\u4ee3\u7801\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u5c42\u53e0\u7684\u8fc7\u7a0b\u5c31\u662f\u904d\u5386\u5b57\u8282\u7801\u7136\u540e\u8c03\u7528\u5c5e\u6027\u8c03\u5ea6\u8868\u4e2d\u6ce8\u518c\u7684 cascade \u51fd\u6570\u3002\u4ee5 width \u5c5e\u6027\u4e3a\u4f8b\uff0c\u5b83\u7684\u5c42\u53e0\u64cd\u4f5c\u7531 select/properties/width.c \u4e2d\u7684 `css__cascade_width()` \u51fd\u6570\u5b9e\u73b0\uff0c\u8be5\u51fd\u6570\u5185\u90e8\u8c03\u7528\u4e86 `css__cascade_length_auto()` \u51fd\u6570\uff1a\\n\\n```c\\n\\ncss_error css__cascade_length_auto(uint32_t opv, css_style *style,\\n                css_select_state *state,\\n                css_error (*fun)(css_computed_style *, uint8_t, css_fixed,\\n                                css_unit))\\n{\\n        uint16_t value = CSS_BOTTOM_INHERIT;\\n        css_fixed length = 0;\\n        uint32_t unit = UNIT_PX;\\n\\n        if (isInherit(opv) == false) {\\n                switch (getValue(opv)) {\\n                case BOTTOM_SET:\\n                        value = CSS_BOTTOM_SET;\\n                        length = *((css_fixed *) style->bytecode);\\n                        advance_bytecode(style, sizeof(length));\\n                        unit = *((uint32_t *) style->bytecode);\\n                        advance_bytecode(style, sizeof(unit));\\n                        break;\\n                case BOTTOM_AUTO:\\n                        value = CSS_BOTTOM_AUTO;\\n                        break;\\n                }\\n        }\\n\\n        unit = css__to_css_unit(unit);\\n\\n        if (css__outranks_existing(getOpcode(opv), isImportant(opv), state,\\n                        isInherit(opv))) {\\n                return fun(state->computed, value, length, unit);\\n        }\\n\\n        return CSS_OK;\\n}\\n```\\n\\n\u5f53\u5c5e\u6027\u503c\u672a\u6307\u5b9a\u4e3a\u7ee7\u627f\u65f6\uff0c\u5bf9\u5b57\u8282\u7801\u4e2d\u8868\u8fbe\u7684\u503c\u8fdb\u884c\u8f6c\u6362\uff0c\u82e5\u5f53\u524d\u5c5e\u6027\u503c\u7684\u6743\u91cd\u5728\u5df2\u6709\u5c5e\u6027\u503c\u4e4b\u4e0a\u5219\u8c03\u7528 `fun` \u6307\u5411\u7684\u56de\u8c03\u51fd\u6570\u6765\u8bbe\u7f6e\u503c\uff0c\u8fd9\u4e2a `fun` \u6307\u9488\u5728 `css__cascade_width()` \u4e2d\u88ab\u8d4b\u503c\u4e3a `set_width`\uff1a\\n\\n```c\\nstatic inline css_error set_width(css_computed_style *style, uint8_t type,\\n                css_fixed length, css_unit unit)\\n{\\n        uint32_t *bits;\\n\\n        bits = &style->i.bits[WIDTH_INDEX];\\n\\n        /* 7bits: uuuuutt : unit | type */\\n        *bits = (*bits & ~WIDTH_MASK) | ((((uint32_t)type & 0x3) | (unit << 2))\\n                        << WIDTH_SHIFT);\\n\\n        style->i.width = length;\\n\\n        return CSS_OK;\\n}\\n```\\n\\n### \u5185\u8054\\n\\n\u5185\u8054\u6837\u5f0f\uff08Inline style\uff09\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u9009\u62e9\u7684\u6837\u5f0f\uff0c\u5b83\u5c42\u53e0\u5728\u9009\u62e9\u7684\u6837\u5f0f\u4e4b\u4e0a\uff0c`css_select_style()` \u5bf9\u5b83\u7684\u5904\u7406\u540c\u6837\u662f\u8c03\u7528 `cascade_style()` \u51fd\u6570\u3002\\n\\n### \u521d\u59cb\u503c\\n\\n\u5f53\u6837\u5f0f\u5c42\u53e0\u5b8c\u540e\uff0c\u672a\u8bbe\u7f6e\u503c\u7684\u5c5e\u6027\u4f1a\u88ab\u8bbe\u7f6e\u521d\u59cb\u503c\u3002\\n\\n### \u7edd\u5bf9\u503c\\n\\n\u7edd\u5bf9\u503c\u662f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7684\u503c\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u6709\u76f8\u5bf9\u503c\u3002CSS \u7684\u90e8\u5206\u5c5e\u6027\u652f\u6301\u4f7f\u7528\u76f8\u5bf9\u5355\u4f4d\u7684\u503c\uff0c\u4f8b\u5982\uff1a`font-size: smaller`\u3001`color: currentColor`\u3001`line-height: 1.6`\u3001`padding-left: 1em`\uff0c\u8fd9\u4e9b\u503c\u5e76\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\uff0c\u9700\u8981\u5728\u5b83\u4eec\u4f9d\u8d56\u7684\u503c\u90fd\u662f\u7edd\u5bf9\u503c\u65f6\u624d\u80fd\u786e\u5b9a\uff0c\u56e0\u6b64\u6837\u5f0f\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u4f1a\u6709\u4e00\u4e2a\u5c06\u76f8\u5bf9\u503c\u8f6c\u6362\u4e3a\u7edd\u5bf9\u503c\u7684\u8ba1\u7b97\u8fc7\u7a0b\u3002\\n\\n\u9664\u4e86 `css_select_style()` \u4f1a\u5728\u5143\u7d20\u4e3a\u6839\u5143\u7d20\u65f6\u4e3a\u5176\u8ba1\u7b97\u7edd\u5bf9\u503c\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u624b\u52a8\u8c03\u7528 `css_computed_style_compose()` \u51fd\u6570\u6765\u5b8c\u6210\u8fd9\u4e00\u8ba1\u7b97\u3002\\n\\n## \u5df2\u8ba1\u7b97\u6837\u5f0f\\n\\nsrc/select/computed.c \u6587\u4ef6\u7684\u5185\u5bb9\u53ef\u5212\u5206\u4e3a\u5c5e\u6027\u8bbf\u95ee\u5668\u3001\u8ba1\u7b97\u51fd\u6570\u3001\u5185\u90e8\u51fd\u6570\u8fd9\u4e09\u4e2a\u90e8\u5206\u3002\\n\\n### \u5c5e\u6027\u8bbf\u95ee\u5668\\n\\n\u5c5e\u6027\u8bbf\u95ee\u5668\u662f\u4e00\u7cfb\u5217\u540d\u79f0\u4ee5 `css_computed_` \u5f00\u5934\u7684\u51fd\u6570\uff0c\u7528\u4e8e\u4ece\u5df2\u8ba1\u7b97\u6837\u5f0f\u7ed3\u6784\u4f53\u4e2d\u83b7\u53d6\u7279\u5b9a\u5c5e\u6027\u7684\u503c\u3002\u5b83\u4eec\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u90fd\u4e3a `uint8_t`\uff0c\u8868\u793a\u5c5e\u6027\u503c\u7684\u7c7b\u578b\uff0c\u4f20\u5165\u7684\u53c2\u6570\u7528\u4e8e\u63a5\u6536\u503c\uff0c\u4f8b\u5982\uff1a\\n\\n```c\\nuint8_t css_computed_width(const css_computed_style *style,\\n                css_fixed *length, css_unit *unit)\\n{\\n        return get_width(style, length, unit);\\n}\\n```\\n\\n\u5bf9\u4e8e left \u8fd9\u79cd\u5728\u7279\u5b9a\u60c5\u51b5\u4e0b\u4f9d\u8d56 position \u548c right \u5c5e\u6027\u624d\u80fd\u8ba1\u7b97\u7684\u5c5e\u6027\uff0c\u5b83\u7684\u8bbf\u95ee\u5668\u4ee3\u7801\u662f\u8fd9\u6837\u7684\uff1a\\n\\n```c\\nuint8_t css_computed_left(const css_computed_style *style,\\n                css_fixed *length, css_unit *unit)\\n{\\n        uint8_t position = css_computed_position(style);\\n        uint8_t left = get_left(style, length, unit);\\n\\n        /* Fix up, based on computed position */\\n        if (position == CSS_POSITION_STATIC) {\\n                /* Static -> auto */\\n                left = CSS_LEFT_AUTO;\\n        } else if (position == CSS_POSITION_RELATIVE) {\\n                /* Relative -> follow $9.4.3 */\\n                uint8_t right = get_right_bits(style);\\n\\n                if (left == CSS_LEFT_AUTO && (right & 0x3) == CSS_RIGHT_AUTO) {\\n                        /* Both auto => 0px */\\n                        *length = 0;\\n                        *unit = CSS_UNIT_PX;\\n                } else if (left == CSS_LEFT_AUTO) {\\n                        /* Left is auto => -right */\\n                        *length = -style->i.right;\\n                        *unit = (css_unit) (right >> 2);\\n                } else {\\n                        /** \\\\todo Consider containing block\'s direction\\n                         * if overconstrained */\\n                }\\n\\n                left = CSS_LEFT_SET;\\n        }\\n\\n        return left;\\n}\\n```\\n\\n### \u8ba1\u7b97\u51fd\u6570\\n\\n\u8ba1\u7b97\u51fd\u6570\u662f\u4e00\u7cfb\u540d\u79f0\u4ee5 `compute_` \u5f00\u5934\u7684\u51fd\u6570\uff0c\u5b83\u4eec\u4e3b\u8981\u88ab`css__compute_absolute_values()` \u51fd\u6570\u8c03\u7528\uff0c\u5176\u4e2d\u5927\u90e8\u5206\u7528\u4e8e\u8ba1\u7b97\u67d0\u7c7b\u5c5e\u6027\u7684\u7edd\u5bf9\u503c\u3002\\n\\n## \u5b58\u50a8\\n\\nLibCSS \u7684\u4f4e\u5185\u5b58\u5360\u7528\u4e3b\u8981\u4f53\u73b0\u5728\u6837\u5f0f\u5b58\u50a8\u4e0a\uff0cCSS \u5b57\u7b26\u4e32\u4e2d\u7684\u6837\u5f0f\u5c5e\u6027\u58f0\u660e\u7ecf\u8fc7\u89e3\u6790\u540e\u4f1a\u8f6c\u6362\u6210\u5185\u5b58\u7a7a\u95f4\u5229\u7528\u7387\u9ad8\u7684\u5b57\u8282\u7801\uff0c\u800c\u5df2\u8ba1\u7b97\u6837\u5f0f\u867d\u7136\u56e0\u5305\u542b\u6240\u6709\u5c5e\u6027\u800c\u5360\u7528\u8f83\u5927\u5185\u5b58\uff0c\u4f46\u4e5f\u505a\u4e86\u4e00\u4e9b\u4f18\u5316\uff0c\u5b83\u7684\u5934\u90e8\u96c6\u4e2d\u5b58\u50a8\u4e86\u6240\u6709\u5c5e\u6027\u503c\u7684\u7c7b\u578b\u6570\u636e\u3002\\n\\n### \u5b57\u8282\u7801\u7684\u5b58\u50a8\u683c\u5f0f\\n\\n\u5b57\u8282\u7801\u662f `unit32_t` \u7c7b\u578b\uff0c\u8868\u8fbe\u4e86 CSS \u5c5e\u6027\u7684\u4ee3\u7801\u3001\u503c\u3001\u662f\u5426\u91cd\u8981\u3001\u662f\u5426\u7ee7\u627f\uff0cbytecode.h \u4e2d\u7684 `buildOPV()` \u51fd\u6570\u5b9a\u4e49\u4ee3\u7801\u5c55\u793a\u4e86\u5b83\u4eec\u662f\u5982\u4f55\u7ec4\u6210\u5b57\u8282\u7801\u7684\uff1a\\n\\n```c\\nstatic inline css_code_t buildOPV(opcode_t opcode, uint8_t flags, uint16_t value)\\n{\\n        return (opcode & 0x3ff) | (flags << 10) | ((value & 0x3fff) << 18);\\n}\\n```\\n\\n\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u5b57\u8282\u7801\u5728\u5185\u5b58\u4e2d\u7684\u5e03\u5c40\uff1a\\n\\n```text\\n| opcode    | flags      | value      |\\n| 1 ~ 11bit | 12 ~ 13bit | 14 ~ 32bit |\\n```\\n\\n\u5bf9\u4e8e\u6709\u591a\u79cd\u7c7b\u578b\u503c\u7684\u5c5e\u6027\uff0c\u5b83\u4eec\u7684 value \u5b57\u6bb5\u4f1a\u88ab\u7528\u6765\u8868\u8fbe\u6570\u636e\u7c7b\u578b\uff0c\u800c\u5b9e\u9645\u503c\u5219\u5b58\u50a8\u5728\u8ffd\u52a0\u7684\u6570\u636e\u6bb5\u4e2d\uff0c\u6bcf\u4e2a\u503c\u5360\u7528\u4e00\u4e2a\u5b57\u8282\u7801\u7684\u7a7a\u95f4\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a\\n\\n```text\\n| CSS_PROP_XXXX | flags | XXXXX_SET | \u5b9e\u9645\u503c1 | \u5b9e\u9645\u503c2 | ... |\\n| 32bits                            | 32bits | 32bits  |     |\\n```\\n\\n\u4ee5 width \u5c5e\u6027\u4e3a\u4f8b\uff0c`width: 10px` \u7684\u5b57\u8282\u7801\u683c\u5f0f\u662f\uff1a\\n\\n```text\\n| CSS_PROP_WIDTH | flags | BOTTOM_SET | FIXED (10) | UNIT (px) |\\n| 32bits                              | 32bits     | 32bits    |\\n```\\n\\n\u800c `width: auto` \u7684\u5b57\u8282\u7801\u683c\u5f0f\u662f\uff1a\\n\\n```text\\n| CSS_PROP_WIDTH | flags | BOTTOM_AUTO |\\n| 32bits                               |\\n```\\n\\ntest/dump.h \u6587\u4ef6\u5c55\u793a\u4e86\u5982\u4f55\u7406\u89e3\u5b57\u8282\u7801\u5e76\u5c06\u5176\u8f93\u51fa\u4e3a CSS \u4ee3\u7801\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67e5\u9605\u5b83\u6765\u4e86\u89e3\u66f4\u591a\u7684\u5b57\u8282\u7801\u64cd\u4f5c\u65b9\u6cd5\u3002\\n\\n### \u5df2\u8ba1\u7b97\u6837\u5f0f\u7684\u5b58\u50a8\u683c\u5f0f\\n\\n\u5df2\u8ba1\u7b97\u6837\u5f0f\u7684\u6570\u636e\u7ed3\u6784\u5b9a\u4e49\u5982\u4e0b\uff1a\\n\\n```c\\nstruct css_computed_style {\\n        struct css_computed_style_i i;\\n\\n        css_computed_content_item *content;\\n        css_computed_counter *counter_increment;\\n        css_computed_counter *counter_reset;\\n        lwc_string **cursor;\\n        lwc_string **font_family;\\n        lwc_string **quotes;\\n\\n        struct css_computed_style *next;\\n        uint32_t count;\\n        uint32_t bin;\\n};\\n```\\n\\n\u9664\u53bb\u5916\u9762\u7684 `cursor` \u548c `font_family` \u7b49\u5c5e\u6027\u5916\uff0c\u5176\u5b83\u5c5e\u6027\u503c\u90fd\u5b58\u50a8\u5728 `css_computed_style_i` \u7ed3\u6784\u4f53\u4e2d\uff0c\u800c\u5176\u4e2d\u7684 `uint32_t bits[15]` \u6210\u5458\u7528\u4e8e\u5b58\u50a8\u8fd9\u4e9b\u503c\u7684\u7c7b\u578b\u4fe1\u606f\uff0c\u4ee5\u6bd4\u7279\u4f4d\u4e3a\u6700\u5c0f\u7c92\u5ea6\u6765\u4e3a\u503c\u7c7b\u578b\u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5177\u4f53\u5206\u914d\u7ec6\u8282\u5728\u5b83\u7684\u6ce8\u91ca\u4e2d\u6709\u8bf4\u660e\uff1a\\n\\n```c\\n/*\\n * Bit allocations:\\n * \\n * 0  ccccccccoooooooobbbbbbbbrrrrrrrr\\n * column_rule_width; outline_width; border_left_width; border_bottom_width\\n * \\n * 1  vvvvvvvvvbbbbbbbboooooooolllllll\\n * vertical_align; border_top_width; border_right_width; letter_spacing\\n * \\n * 2  ccccccccccccccccccccccccccpppppp\\n * clip; padding_top\\n * \\n * 3  mmmmmmmaaaaaaarrrrrrrttttttddddd\\n * max_width; margin_bottom; margin_left; text_indent; display\\n */\\n```\\n\\n\u90e8\u5206\u5c5e\u6027\u7684\u503c\u7c7b\u578b\u53ea\u5360\u4e00\u4e2a\u6bd4\u7279\u4f4d\uff0c\u4f8b\u5982 opacity \u548c windows \u5c5e\u6027\uff1a\\n\\n```c\\n/*\\n * 14 llcbqopwfrue....................\\n * list_style_position; counter_increment; background_image; quotes; order;\\n * opacity; widows; flex_grow; orphans; counter_reset; flex_shrink\\n */\\n```\\n\\nproperties.h \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u6bcf\u4e2a\u5c5e\u6027\u7684\u503c\u7c7b\u578b\u679a\u4e3e\uff0c\u5b83\u4eec\u7684\u53d6\u503c\u8303\u56f4\u90fd\u5f88\u5c0f\uff0c\u56e0\u6b64\u5f88\u5bb9\u6613\u505a\u5230\u4ec5\u5360\u7528\u51e0\u4e2a\u6bd4\u7279\u4f4d\u7a7a\u95f4\u3002\\n\\n\u7531\u4e8e\u8fd9\u79cd\u5360\u7528\u82e5\u5e72\u4e2a\u6bd4\u7279\u4f4d\u7684\u6570\u636e\u4e0d\u4fbf\u4e8e\u76f4\u63a5\u8bfb\u5199\uff0cLibCSS \u5206\u522b\u5728 src/select/autogenerated_propget.h \u548c src/select/autogenerated_propset.h \u4e2d\u4e3a\u6bcf\u4e2a\u5c5e\u6027\u5b9a\u4e49\u4e86\u8bfb\u5199\u8f85\u52a9\u51fd\u6570\uff0c\u5b83\u4eec\u7684\u5b9e\u73b0\u4ee3\u7801\u5927\u540c\u5c0f\u5f02\uff0c\u90fd\u662f\u5148\u786e\u5b9a\u5c5e\u6027\u5728 bits \u4e2d\u7684\u4f4d\u7f6e\u7136\u540e\u901a\u8fc7\u4f4d\u8fd0\u7b97\u6765\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u3002\\n\\n## \u603b\u7ed3\\n\\n\u901a\u8fc7\u4e0a\u8ff0\u7684\u5206\u6790\uff0c\u7b14\u8005\u5f97\u5230\u7684 lcui/css \u4e0e LibCSS \u7684\u5dee\u5f02\u5982\u4e0b\uff1a\\n\\n<table>\\n        <thead>\\n                <tr>\\n                        <th width=\\"200\\">\u5dee\u5f02\u70b9</th>\\n                        <th>LibCSS </th>\\n                        <th>lcui/css</th>\\n                </tr>\\n        </thead>\\n        <tbody>\\n                <tr>\\n                        <td>\\n                        \u89e3\u6790\u529f\u80fd\u8bbe\u8ba1\\n                        </td>\\n                        <td>\\n                        \u7531\u8bcd\u6cd5\u89e3\u6790\u5668\u3001\u8bed\u6cd5\u89e3\u6790\u5668\u3001\u5c5e\u6027\u89e3\u6790\u5668\u548c\u8bed\u8a00\u89e3\u6790\u5668\u7ec4\u6210\\n                        </td>\\n                        <td>\\n                        \u7531\u8bed\u8a00\u89e3\u6790\u5668\u3001CSS \u5c5e\u6027\u8868\u3001CSS \u503c\u5b9a\u4e49\u8868\u7ec4\u6210\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u5c5e\u6027\u58f0\u660e\u7684\u89e3\u6790\u8fc7\u7a0b\\n                        </td>\\n                        <td>\\n                        \u8bed\u6cd5\u89e3\u6790\u5668\u89e6\u53d1\u4e8b\u4ef6\u901a\u77e5\u8bed\u8a00\u89e3\u6790\u5668\u8c03\u7528\u5bf9\u5e94\u7684\u5c5e\u6027\u89e3\u6790\u5668\u8fdb\u884c\u89e3\u6790\\n                        </td>\\n                        <td>\\n                        \u89e3\u6790\u5668\u4ece\u5c5e\u6027\u8868\u4e2d\u83b7\u53d6\u5c5e\u6027\u7684\u503c\u5b9a\u4e49\uff0c\u7136\u540e\u4ece\u5b57\u7b26\u4e32\u4e2d\u63d0\u53d6\u4e0e\u503c\u5b9a\u4e49\u76f8\u5339\u914d\u7684\u503c\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6dfb\u52a0\u81ea\u5b9a\u4e49\u5c5e\u6027\u89e3\u6790\u5668\\n                        </td>\\n                        <td>\\n                        \u9700\u8981\u4fee\u6539\u548c\u91cd\u65b0\u7f16\u8bd1 LibCSS \u7684\u6e90\u4ee3\u7801\\n                        </td>\\n                        <td>\\n                        \u5728\u8fd0\u884c\u65f6\u8c03\u7528\u76f8\u5173\u51fd\u6570\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5c5e\u6027\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6837\u5f0f\u8868\\n                        </td>\\n                        <td>\\n                        \u6837\u5f0f\u6570\u636e\u90fd\u5b58\u5728\u6837\u5f0f\u8868\u4e2d\uff0c\u63d0\u4f9b\u76f8\u5173\u64cd\u4f5c\u51fd\u6570\\n                        </td>\\n                        <td>\\n                        \u4e0d\u5b58\u5728\u6837\u5f0f\u8868\u7684\u6982\u5ff5\uff0c\u52a0\u8f7d\u7684\u6837\u5f0f\u6570\u636e\u90fd\u5b58\u50a8\u5728\u5168\u5c40\u6570\u636e\u8868\u4e2d\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                                \u6837\u5f0f\u67e5\u8be2\u8303\u56f4\\n                        </td>\\n                        <td>\\n                         \u4e00\u4e2a\u6216\u591a\u4e2a\u6837\u5f0f\u8868\\n                        </td>\\n                        <td>\\n                        \u5168\u5c40\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6837\u5f0f\u9009\u62e9\u51fd\u6570\u7684\u7528\u6cd5\\n                        </td>\\n                        <td>\\n                        \u4f20\u5165\u7ed3\u70b9 (node) \u53ca\u5176\u64cd\u4f5c\u65b9\u6cd5\u96c6 (handler)\\n                        </td>\\n                        <td>\\n                        \u4f20\u5165\u9009\u62e9\u5668 (selector)\uff0c\u8be5\u53c2\u6570\u662f\u7ec4\u4ef6\u7236\u5b50\u5173\u7cfb\u94fe\u7684\u7cbe\u7b80\u7248\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u5305\u542b\u7ec4\u4ef6\u7684 id\u3001type\u3001class \u7b49\u5c5e\u6027\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6837\u5f0f\u9009\u62e9\u80fd\u529b\\n                        </td>\\n                        <td>\\n                        \u8f83\u4e3a\u5168\u9762\\n                        </td>\\n                        <td>\\n                        \u53ea\u652f\u6301 id\u3001type\u3001class\u3001:first-child\u3001:last-child\uff0c\u8fd9\u7c7b\u7b80\u5355\u7684\u9009\u62e9\u7b26\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6837\u5f0f\u9009\u62e9\u4f18\u5316\\n                        </td>\\n                        <td>\\n                        \u4e3a\u8282\u70b9\u63d0\u4f9b bloom \u8fc7\u6ee4\u5668\uff0c\u6839\u636e\u8282\u70b9\u7684\u7956\u5148\u5143\u7d20\u540d\u3001\u7c7b\u540d\u548c id \u540d\u751f\u6210\uff0c\u53ef\u7528\u4e8e\u83b7\u53d6\u548c\u7f13\u5b58\u5df2\u67e5\u8be2\u7684\u6837\u5f0f\\n                        </td>\\n                        <td>\\n                        \u867d\u7136\u5e93\u5185\u90e8\u6ca1\u6709\u505a\u4f18\u5316\uff0c\u4f46\u5728 lcui/ui \u5e93\u4e2d\u6709\u5b9e\u73b0\u4e0e LibCSS \u7684 bloom \u8fc7\u6ee4\u5668\u76f8\u4f3c\u7684\u4f18\u5316\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u6837\u5f0f\u8ba1\u7b97\\n                        </td>\\n                        <td>\\n                        \u91c7\u7528\u4e24\u6b65\u5f0f\u6837\u5f0f\u8ba1\u7b97\u65b9\u6cd5\uff0c\u7b2c\u4e00\u6b65\u8ba1\u7b97\u7ee7\u627f\u503c\u3001\u521d\u59cb\u503c\u548c\u5c42\u53e0\u6837\u5f0f\uff0c\u7b2c\u4e8c\u6b65\u8ba1\u7b97\u7edd\u5bf9\u503c\uff0c\u8fd9\u79cd\u65b9\u6cd5\u65e8\u5728\u5141\u8bb8\u5ba2\u6237\u7aef\u5b58\u50a8\u90e8\u5206\u5df2\u8ba1\u7b97\u6837\u5f0f\uff0c\u5e76\u5728\u5e03\u5c40\u53d8\u52a8\u65f6\u9ad8\u6548\u5730\u66f4\u65b0\u8282\u70b9\u7684\u5b8c\u6574\u5df2\u8ba1\u7b97\u6837\u5f0f\\n                        </td>\\n                        <td>\\n                        \u65e0\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u5c5e\u6027\u8bbf\u95ee\u65b9\u6cd5\\n                        </td>\\n                        <td>\\n                        \u8c03\u7528\u5c5e\u6027\u8bbf\u95ee\u51fd\u6570\u83b7\u53d6\u5c5e\u6027\u503c\\n                        </td>\\n                        <td>\\n                        \u76f4\u63a5\u8bbf\u95ee\u7ed3\u6784\u4f53\u6210\u5458\uff0c\u65e0\u76f8\u5173\u8f85\u52a9\u51fd\u6570\\n                        </td>\\n                </tr>\\n                <tr>\\n                        <td>\\n                        \u5c5e\u6027\u503c\u5b58\u50a8\u65b9\u5f0f\\n                        </td>\\n                        <td>\\n                        \u7528\u82e5\u5e72\u4e2a\u6bd4\u7279\u4f4d\u8bb0\u5f55\u503c\u7684\u7c7b\u578b\u548c\u5355\u4f4d\uff0c\u82e5\u6709\u5176\u5b83\u503c\u5219\u4f1a\u5728\u53e6\u4e00\u5757\u7a7a\u95f4\u4e2d\u5b58\u50a8\u503c\uff0c\u8fd9\u6837\u80fd\u505a\u5230\u8ba9\u90e8\u5206\u5c5e\u6027\u7684\u503c\u53ea\u5360\u7528\u82e5\u5e72\u4e2a\u6bd4\u7279\u4f4d\uff0c\u5185\u5b58\u5229\u7528\u7387\u8f83\u9ad8\\n                        </td>\\n                        <td>\\n                        \u5c5e\u6027\u7684\u7c7b\u578b\u3001\u503c\u548c\u5355\u4f4d\u90fd\u662f\u72ec\u7acb\u7684\u7ed3\u6784\u4f53\u6210\u5458\uff0c\u6bcf\u4e2a\u5c5e\u6027\u7684\u503c\u81f3\u5c11\u5360\u7528 24 \u5b57\u8282\uff0c\u5185\u5b58\u5229\u7528\u7387\u4f4e\\n                        </td>\\n                </tr>\\n        </tbody>\\n</table>\\n\\nLibCSS \u5728\u89e3\u6790\u5668\u7684\u8bbe\u8ba1\u4e0a\u660e\u663e\u4f18\u4e8e lcui/css\uff0c\u9020\u6210\u8fd9\u4e00\u5dee\u8ddd\u7684\u539f\u56e0\u5728\u4e8e\u7b14\u8005\u5e76\u672a\u5b66\u4e60\u8fc7\u7f16\u8bd1\u539f\u7406\u5e76\u638c\u63e1\u76f8\u5173\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u6b63\u56e0\u4e3a\u5982\u6b64\uff0clcui/css \u6240\u91c7\u7528\u7684\u8bbe\u8ba1\u6a21\u5f0f\u5728\u7ecf\u5386\u8fc7\u6570\u6b21\u6539\u8fdb\u548c\u91cd\u5199\u624d\u53ea\u8fbe\u5230\u73b0\u5728\u8fd9\u79cd\u7a0b\u5ea6\uff0c\u867d\u7136\u770b\u4e0a\u53bb\u53d8\u5f97\u66f4\u6210\u719f\u7a33\u5b9a\u4e86\uff0c\u4f46\u4e0e LibCSS \u7684\u8bbe\u8ba1\u6a21\u5f0f\u76f8\u6bd4\u53ea\u662f\u4e2a\u4f4e\u914d\u7248\u3002\\n\\n\u73b0\u5728\u770b\u6765\uff0c\u4e0e\u5176\u6d6a\u8d39\u5927\u91cf\u65f6\u95f4\u57fa\u4e8e\u6700\u521d\u7684\u81ea\u8ba4\u4e3a\u5f88\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u6848\u6301\u7eed\u6539\u8fdb\uff0c\u8fd8\u4e0d\u5982\u82b1\u5c11\u91cf\u65f6\u95f4\u5b66\u4e60\u5e76\u5e94\u7528\u73b0\u6709\u4e14\u6210\u719f\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002\u4e0d\u8fc7\u8fd9\u4e5f\u4f53\u73b0\u4e86\u7406\u8bba\u77e5\u8bc6\u50a8\u5907\u7684\u91cd\u8981\u6027\uff0c\u5b83\u80fd\u8ba9\u4f60\u5feb\u901f\u627e\u5230\u5408\u9002\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4e0d\u7528\u4e3a\u4e86\u91cd\u590d\u89e3\u51b3\u522b\u4eba\u65e9\u5df2\u89e3\u51b3\u8fc7\u7684\u95ee\u9898\u800c\u6d6a\u8d39\u8fc7\u591a\u65f6\u95f4\u53bb\u7814\u7a76\u3001\u5b9e\u8df5\u548c\u6539\u8fdb\u3002\\n\\n\u5f53\u7136\uff0c\u4e0d\u53ea\u662f CSS \u89e3\u6790\u5668\u8fd9\u5757\u529f\u80fd\u5b58\u5728\u95ee\u9898\uff0c\u7531\u4e8e\u7b14\u8005\u5728\u5f00\u53d1 CSS \u5e93\u4e4b\u524d\u5e76\u672a\u7cfb\u7edf\u5730\u5b66\u4e60\u8fc7 CSS \u76f8\u5173\u672f\u8bed\u548c\u6982\u5ff5\uff0cCSS \u5e93\u7684\u5185\u90e8\u63a5\u53e3\u8bbe\u8ba1\u548c\u547d\u540d\u90fd\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\u3002\\n\\n### \u74f6\u9888\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\\n\\n\u5982\u4f55\u63d0\u53d6\u503c\uff1f\u7b14\u8005\u5728\u7814\u7a76 LibCSS \u4e4b\u524d\u60f3\u5230\u7684\u89e3\u51b3\u65b9\u6848\u662f\uff1a\u5148\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4\uff0c\u5305\u542b\u503c\u7c7b\u578b\u4e0e\u76ee\u6807\u503c\u7684\u6307\u9488\uff0c\u7136\u540e\u904d\u5386\u8fd9\u4e2a\u6570\u7ec4\u627e\u51fa\u7c7b\u578b\u5339\u914d\u7684\u503c\u5e76\u5c06\u4e4b\u5199\u5165\u5230\u76ee\u6807\u503c\u7684\u6307\u9488\u6307\u5411\u7684\u7a7a\u95f4\u5185\u3002\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```ts\\ninterface CSSValueResolveRule {\\n        type: CSSValueType;\\n        key: string;\\n}\\n\\nfunction resolveCSSValue(input: CSSValue[], rules: CSSValueResolveRule[], output: Record<string, CSSValue>) {\\n        const resolvedValues = new Array(input.length).fill(false);\\n        ruless.forEach((rule) => {\\n                input.some((value, i) => {\\n                        if (!resolvedValues[i] && matchCSSValueType(value, rule.type)) {\\n                                output[rule.key] = value;\\n                                resolvedValues[i] = true;\\n                                return true;\\n                        }\\n                        return false;\\n                });\\n        });\\n        return resolvedValues.every(Boolean);\\n}\\n```\\n\\n\u7136\u800c\u4e00\u4e2a\u5c5e\u6027\u53ef\u4ee5\u6709\u591a\u4e2a\u503c\u4e14\u503c\u53ef\u4ee5\u6709\u591a\u79cd\u7c7b\u578b\uff0c\u8fd9\u79cd\u65b9\u6848\u5e76\u4e0d\u9002\u7528\u3002\\n\\n\u5982\u679c\u8003\u8651\u591a\u503c\u591a\u7c7b\u578b\u7684\u60c5\u51b5\uff0c\u90a3\u5c31\u8fd8\u8981\u89e3\u51b3\u5339\u914d\u5ea6\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u7b80\u5199\u5c5e\u6027 margin \u7684\u56db\u79cd\u5199\u6cd5\uff1a`margin: 4px`\u3001`margin: 4px 8px`\u3001`margin: 4px 8px 4px`\u3001`margin: 4px 8px 4px 8px`\uff0c\u540c\u6837\u662f length \u7c7b\u578b\u7684\u503c\uff0c\u4e0d\u540c\u6570\u91cf\u6709\u4e0d\u540c\u7684\u6548\u679c\u3002\u8fd9\u4e9b\u503c\u7684\u6570\u91cf\u6821\u9a8c\u5728\u503c\u5339\u914d\u5668\u4e2d\u5df2\u7ecf\u505a\u8fc7\u4e86\uff0c\u90a3\u4e48\uff0c\u662f\u5426\u53ef\u4ee5\u6539\u8fdb\u503c\u5339\u914d\u5668\u4f7f\u4e4b\u652f\u6301\u81ea\u5b9a\u4e49\u503c\u7684\u63d0\u53d6\u65b9\u5f0f\uff1f\u5982\u679c\u4e0d\u6539\u8fdb\uff0c\u90a3\u5728\u503c\u63d0\u53d6\u5668\u548c\u5c5e\u6027\u5c42\u53e0\u51fd\u6570\u91cc\u505a\u91cd\u590d\u7684\u503c\u6821\u9a8c\u6709\u4ec0\u4e48\u610f\u4e49\uff1f\u4e00\u60f3\u5230\u8fd9\u91cc\uff0c\u7b14\u8005\u53d1\u73b0\u8981\u89e3\u51b3\u7684\u95ee\u9898\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u800c\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u6240\u5e26\u6765\u7684\u6536\u76ca\u4e0e\u6295\u5165\u7684\u6210\u672c\u5e76\u4e0d\u5339\u914d\uff0c\u4e8e\u662f\u51b3\u5b9a\u653e\u5f03\u601d\u8003\uff0c\u6539\u4e3a\u7814\u7a76 LibCSS \u7684\u505a\u6cd5\u3002\\n\\n\u7ecf\u8fc7\u4e0a\u8ff0\u5bf9 LibCSS \u7684\u7814\u7a76\uff0c\u9274\u4e8e\u503c\u63d0\u53d6\u65b9\u5f0f\u7684\u4f18\u5316\u6210\u672c\u8fc7\u9ad8\uff0c\u7b14\u8005\u51b3\u5b9a\u6539\u7528\u5e38\u89c4\u7684\u65b9\u5f0f\u6765\u63d0\u53d6\u503c\uff0c\u5373\u4fbf\u5404\u4e2a\u7b80\u5199\u5c5e\u6027\u7684\u503c\u63d0\u53d6\u5b9e\u73b0\u4ee3\u7801\u662f\u76f8\u4f3c\u7684\u3002\\n\\n### \u6539\u8fdb\u8ba1\u5212\\n\\nLibCSS \u5728\u89e3\u6790\u5668\u3001\u9009\u62e9\u5f15\u64ce\u548c\u6570\u636e\u7ed3\u6784\u7b49\u65b9\u9762\u7684\u8bbe\u8ba1\u4e3a lcui/css \u672a\u6765\u7684\u6539\u8fdb\u63d0\u4f9b\u4e86\u53ef\u9760\u7684\u53c2\u8003\uff0c\u76ee\u524d\u53ef\u505a\u7684\u6539\u8fdb\u6709\uff1a\\n\\n- \u6539\u7528\u5b57\u8282\u7801\u7ec4\u4ee3\u66ff\u94fe\u8868\u6765\u5b58\u50a8 CSS \u89c4\u5219\\n- \u5f15\u5165\u6837\u5f0f\u8868\u3001\u9009\u62e9\u4e0a\u4e0b\u6587\u3001\u5df2\u8ba1\u7b97\u6837\u5f0f\u7b49\u6982\u5ff5\\n- \u5c06\u6837\u5f0f\u8ba1\u7b97\u51fd\u6570\u6539\u6210\u4e0e `css_select_style()` \u76f8\u4f3c\u7684\u7528\u6cd5\\n- \u5c06 lcui/ui \u5e93\u4e2d\u7684\u6837\u5f0f\u9009\u62e9\u4f18\u5316\u6574\u5408\u8fdb lcui/css \u5e93\u4e2d\\n- \u5c06 lcui/ui \u5e93\u4e2d\u7684\u6837\u5f0f\u8ba1\u7b97\u903b\u8f91\u6574\u5408\u8fdb lcui/css \u5e93\u4e2d\\n- \u4f18\u5316\u5df2\u8ba1\u7b97\u503c\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u51cf\u5c11\u5185\u5b58\u5360\u7528\\n- \u589e\u52a0\u7edd\u5bf9\u503c\u8ba1\u7b97\u6d41\u7a0b\\n- \u589e\u52a0\u5c5e\u6027\u8bbf\u95ee\u5668\\n\\n### LibCSS \u7f3a\u5931\u7684\u5c5e\u6027\\n\\n\u5728\u7b14\u8005\u7814\u7a76\u5c5e\u6027\u89e3\u6790\u5668\u7684\u8fc7\u7a0b\u4e2d\u6709\u6ce8\u610f\u5230\u4e00\u4e9b\u5c5e\u6027\u6ca1\u6709\u89e3\u6790\u5668\uff0c\u751a\u81f3\u8fde\u5305\u542b\u76f8\u5173\u5173\u952e\u5b57\u7684\u4ee3\u7801\u90fd\u6ca1\u6709\uff0c\u4f8b\u5982\uff1a\\n\\n- background-size\\n- border-radius\\n- box-shadow\\n\\n\u6216\u8bb8\u662f\u56e0\u4e3a NetSurf \u6d4f\u89c8\u5668\u8fd8\u4e0d\u652f\u6301\u7ed8\u5236\u81ea\u5b9a\u4e49\u5c3a\u5bf8\u7684\u80cc\u666f\u56fe\u3001\u5706\u89d2\u8fb9\u6846\u548c\u9634\u5f71\u5427\u3002"}]}}')}}]);